<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>TipTapElement</title>
    <style>
      html, body {
        margin: 0;
        height: 100%;
      }

      body {
        padding: 2rem;
      }

      body {
        max-width: 100%;
      }
      :where(:not(:defined)) {
        visibility: hidden;
      }
    </style>
    <script type="module" src="/dist/tip-tap-element.js"></script>
    <script type="module">
      ;(async function () {
        await window.customElements.whenDefined("tip-tap-trix");

        const input = document.querySelector("#my-input")
        const readonly = document.querySelector("#readonly")

        document.addEventListener("DOMContentLoad", () => {
          readonly.editor.commands.setContent(input.value)
        })

        replaceWithWrapper(input, "value", function(obj, property, value) {
          readonly.editor.commands.setContent(value)
        });

        function replaceWithWrapper(obj, property, callback) {
          Object.defineProperty(obj, property, new function() {
            var _value = obj[property];
            return {
              set: function(value) {
                _value = value;
                callback(obj, property, value)
              },
              get: function() {
                return _value;
              }
            }
          });
        }
      })()
    </script>
  </head>
  <body>
    The following can be instantiated like this:

    <br>

    <code>
      &lt;form&gt;
        <br>
        &nbsp;&nbsp;&lt;input id="my-input" type="hidden"&gt;
        <br>
        &nbsp;&nbsp;&lt;tip-tap-trix input="my-input"&gt;&lt;/tip-tap-trix&gt;
      <br>
      &lt;/form&gt;
    </code>

    <br><br>

    Because the following is not hooked up a backend for direct-uploads,
    none of the images will save properly or be displayed in the output editor.

    <br><br><br><br><br>

    <form>
      <input id="my-input" type="hidden">
      <tip-tap-trix input="my-input"></tip-tap-trix>
    </form>

    <br><br><br><br><br>

    Mirrored output in a readonly instance:
    <br>

    <tip-tap-trix id="readonly" readonly></tip-tap-trix>
  </body>
</html>
